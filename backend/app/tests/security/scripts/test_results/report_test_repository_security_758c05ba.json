{"created": 1744671643.3021529, "duration": 0.8598997592926025, "exitcode": 1, "root": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend", "environment": {}, "summary": {"error": 10, "total": 10, "collected": 10}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "app/tests/security/db/test_repository_security.py", "type": "Module"}]}, {"nodeid": "app/tests/security/db/test_repository_security.py", "outcome": "passed", "result": [{"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_creation_encrypts_phi", "type": "Function", "lineno": 50}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_retrieval_decrypts_phi", "type": "Function", "lineno": 84}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_repository_filters_inactive_records", "type": "Function", "lineno": 115}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_audit_logging_on_patient_changes", "type": "Function", "lineno": 129}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_authorization_check_before_operations", "type": "Function", "lineno": 159}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_phi_never_appears_in_exceptions", "type": "Function", "lineno": 190}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_bulk_operations_maintain_encryption", "type": "Function", "lineno": 210}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_search_filters_without_exposing_phi", "type": "Function", "lineno": 227}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_encryption_key_rotation", "type": "Function", "lineno": 257}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_field_level_encryption", "type": "Function", "lineno": 289}]}], "tests": [{"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_creation_encrypts_phi", "lineno": 50, "outcome": "error", "keywords": ["test_patient_creation_encrypts_phi", "db_required", "pytestmark", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04962633299874142, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105bb6f90> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "stdout": "Loaded test environment variables from: /Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/.env.test\n", "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671642.560794, "msecs": 560.0, "relativeCreated": 201.667, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671642.5609019, "msecs": 560.0, "relativeCreated": 201.775, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671642.6085398, "msecs": 608.0, "relativeCreated": 249.413, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105cb6dd0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105bb6f90> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.0001664580195210874, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_retrieval_decrypts_phi", "lineno": 84, "outcome": "error", "keywords": ["test_patient_retrieval_decrypts_phi", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04362770798616111, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105e28b90> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671642.652352, "msecs": 652.0, "relativeCreated": 293.225, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671642.652433, "msecs": 652.0, "relativeCreated": 293.306, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671642.6953542, "msecs": 695.0, "relativeCreated": 336.227, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e30590>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105e28b90> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00012566702207550406, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_repository_filters_inactive_records", "lineno": 115, "outcome": "error", "keywords": ["test_repository_filters_inactive_records", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.043502749991603196, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105e29810> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671642.72277, "msecs": 722.0, "relativeCreated": 363.643, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671642.72284, "msecs": 722.0, "relativeCreated": 363.713, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671642.765745, "msecs": 765.0, "relativeCreated": 406.618, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e310f0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105e29810> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00012954202247783542, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_audit_logging_on_patient_changes", "lineno": 129, "outcome": "error", "keywords": ["test_audit_logging_on_patient_changes", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04429104196606204, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cce650> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671642.794316, "msecs": 794.0, "relativeCreated": 435.189, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671642.794388, "msecs": 794.0, "relativeCreated": 435.261, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671642.837971, "msecs": 837.0, "relativeCreated": 478.844, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e31a90>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cce650> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.0001355410204268992, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_authorization_check_before_operations", "lineno": 159, "outcome": "error", "keywords": ["test_authorization_check_before_operations", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04485412500798702, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105ccf230> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671642.866903, "msecs": 866.0, "relativeCreated": 507.776, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671642.8669891, "msecs": 866.0, "relativeCreated": 507.862, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671642.91111, "msecs": 911.0, "relativeCreated": 551.983, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e327b0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105ccf230> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00016183301340788603, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_phi_never_appears_in_exceptions", "lineno": 190, "outcome": "error", "keywords": ["test_phi_never_appears_in_exceptions", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.044233832973986864, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105d60a70> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671642.94095, "msecs": 940.0, "relativeCreated": 581.823, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671642.941028, "msecs": 941.0, "relativeCreated": 581.901, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671642.984552, "msecs": 984.0, "relativeCreated": 625.425, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:42"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e333f0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105d60a70> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00013704202137887478, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_bulk_operations_maintain_encryption", "lineno": 210, "outcome": "error", "keywords": ["test_bulk_operations_maintain_encryption", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04388383298646659, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cafac0> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671643.013491, "msecs": 13.0, "relativeCreated": 654.364, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671643.0135748, "msecs": 13.0, "relativeCreated": 654.448, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671643.056749, "msecs": 56.0, "relativeCreated": 697.622, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e1c210>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cafac0> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00014212500536814332, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_search_filters_without_exposing_phi", "lineno": 227, "outcome": "error", "keywords": ["test_search_filters_without_exposing_phi", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04450754099525511, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105caf570> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671643.0865111, "msecs": 86.0, "relativeCreated": 727.384, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671643.086586, "msecs": 86.0, "relativeCreated": 727.459, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671643.130356, "msecs": 130.0, "relativeCreated": 771.229, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e333f0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105caf570> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00015254196478053927, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_encryption_key_rotation", "lineno": 257, "outcome": "error", "keywords": ["test_encryption_key_rotation", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04341487499186769, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cb2850> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671643.1584, "msecs": 158.0, "relativeCreated": 799.273, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671643.158475, "msecs": 158.0, "relativeCreated": 799.348, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671643.201535, "msecs": 201.0, "relativeCreated": 842.408, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e327b0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cb2850> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.0001092919846996665, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_field_level_encryption", "lineno": 289, "outcome": "error", "keywords": ["test_field_level_encryption", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04380354203749448, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cb1c50> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671643.228645, "msecs": 228.0, "relativeCreated": 869.518, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671643.228711, "msecs": 228.0, "relativeCreated": 869.584, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671643.272213, "msecs": 272.0, "relativeCreated": 913.086, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31205, "taskName": null, "asctime": "2025-04-14 19:00:43"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x105e319b0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x105cb1c50> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00016424997011199594, "outcome": "passed"}}]}