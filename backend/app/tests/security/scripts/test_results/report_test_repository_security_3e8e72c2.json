{"created": 1744671638.487463, "duration": 0.8686549663543701, "exitcode": 1, "root": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend", "environment": {}, "summary": {"error": 10, "total": 10, "collected": 10}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "app/tests/security/db/test_repository_security.py", "type": "Module"}]}, {"nodeid": "app/tests/security/db/test_repository_security.py", "outcome": "passed", "result": [{"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_creation_encrypts_phi", "type": "Function", "lineno": 50}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_retrieval_decrypts_phi", "type": "Function", "lineno": 84}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_repository_filters_inactive_records", "type": "Function", "lineno": 115}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_audit_logging_on_patient_changes", "type": "Function", "lineno": 129}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_authorization_check_before_operations", "type": "Function", "lineno": 159}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_phi_never_appears_in_exceptions", "type": "Function", "lineno": 190}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_bulk_operations_maintain_encryption", "type": "Function", "lineno": 210}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_search_filters_without_exposing_phi", "type": "Function", "lineno": 227}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_encryption_key_rotation", "type": "Function", "lineno": 257}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_field_level_encryption", "type": "Function", "lineno": 289}]}], "tests": [{"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_creation_encrypts_phi", "lineno": 50, "outcome": "error", "keywords": ["test_patient_creation_encrypts_phi", "db_required", "pytestmark", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.050435999990440905, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104d26f90> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "stdout": "Loaded test environment variables from: /Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/.env.test\n", "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671637.745027, "msecs": 745.0, "relativeCreated": 214.622, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671637.745146, "msecs": 745.0, "relativeCreated": 214.741, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671637.7934651, "msecs": 793.0, "relativeCreated": 263.06, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104e1edd0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104d26f90> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.0001787500223144889, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_patient_retrieval_decrypts_phi", "lineno": 84, "outcome": "error", "keywords": ["test_patient_retrieval_decrypts_phi", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04446216701762751, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104ff8b90> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671637.83796, "msecs": 837.0, "relativeCreated": 307.555, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671637.838052, "msecs": 838.0, "relativeCreated": 307.647, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671637.881687, "msecs": 881.0, "relativeCreated": 351.282, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104ffc590>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104ff8b90> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00015470798825845122, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_repository_filters_inactive_records", "lineno": 115, "outcome": "error", "keywords": ["test_repository_filters_inactive_records", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.044309290999080986, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104ff9810> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671637.911225, "msecs": 911.0, "relativeCreated": 380.82, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671637.911305, "msecs": 911.0, "relativeCreated": 380.9, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671637.9549341, "msecs": 954.0, "relativeCreated": 424.529, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104ffd0f0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104ff9810> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00015700003132224083, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_audit_logging_on_patient_changes", "lineno": 129, "outcome": "error", "keywords": ["test_audit_logging_on_patient_changes", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04413400002522394, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e36650> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671637.984954, "msecs": 984.0, "relativeCreated": 454.549, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671637.985035, "msecs": 985.0, "relativeCreated": 454.63, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:37"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671638.0284731, "msecs": 28.0, "relativeCreated": 498.068, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104ffda90>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e36650> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.000134292000439018, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_authorization_check_before_operations", "lineno": 159, "outcome": "error", "keywords": ["test_authorization_check_before_operations", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04424233402824029, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e37230> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671638.056016, "msecs": 56.0, "relativeCreated": 525.611, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671638.056088, "msecs": 56.0, "relativeCreated": 525.683, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671638.0997472, "msecs": 99.0, "relativeCreated": 569.342, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104ffe7b0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e37230> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00012179097393527627, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_phi_never_appears_in_exceptions", "lineno": 190, "outcome": "error", "keywords": ["test_phi_never_appears_in_exceptions", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04466600000159815, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104f34a70> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671638.127768, "msecs": 127.0, "relativeCreated": 597.363, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671638.127838, "msecs": 127.0, "relativeCreated": 597.433, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671638.171733, "msecs": 171.0, "relativeCreated": 641.328, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104fff3f0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104f34a70> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00015533302212134004, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_bulk_operations_maintain_encryption", "lineno": 210, "outcome": "error", "keywords": ["test_bulk_operations_maintain_encryption", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04424925002967939, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e17ac0> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671638.201142, "msecs": 201.0, "relativeCreated": 670.737, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671638.2012181, "msecs": 201.0, "relativeCreated": 670.813, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671638.244735, "msecs": 244.0, "relativeCreated": 714.33, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x10509c210>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e17ac0> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.0001569580053910613, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_search_filters_without_exposing_phi", "lineno": 227, "outcome": "error", "keywords": ["test_search_filters_without_exposing_phi", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.044244833989068866, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e17570> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671638.2743309, "msecs": 274.0, "relativeCreated": 743.926, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671638.27442, "msecs": 274.0, "relativeCreated": 744.015, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671638.3179688, "msecs": 317.0, "relativeCreated": 787.564, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104fff3f0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e17570> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.0001437500468455255, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_encryption_key_rotation", "lineno": 257, "outcome": "error", "keywords": ["test_encryption_key_rotation", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.04402691702125594, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e1a850> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671638.345508, "msecs": 345.0, "relativeCreated": 815.103, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671638.345591, "msecs": 345.0, "relativeCreated": 815.186, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671638.389251, "msecs": 389.0, "relativeCreated": 858.846, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104ffe7b0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e1a850> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.0001593749620951712, "outcome": "passed"}}, {"nodeid": "app/tests/security/db/test_repository_security.py::test_field_level_encryption", "lineno": 289, "outcome": "error", "keywords": ["test_field_level_encryption", "test_repository_security.py", "db", "security", "tests", "app", "backend", ""], "setup": {"duration": 0.043866291001904756, "outcome": "failed", "crash": {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e19c50> does not have the attribute '_load_encryption_key'"}, "traceback": [{"path": "db/test_repository_security.py", "lineno": 30, "message": ""}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1495, "message": "in __enter__"}, {"path": "/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py", "lineno": 1465, "message": "AttributeError"}], "log": [{"name": "encryption_service", "msg": "No encryption key provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 56, "funcName": "__init__", "created": 1744671638.4170072, "msecs": 417.0, "relativeCreated": 886.602, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "No encryption salt provided or found in environment. Generated a new one. This should be stored securely.", "args": null, "levelname": "WARNING", "levelno": 30, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 71, "funcName": "__init__", "created": 1744671638.417087, "msecs": 417.0, "relativeCreated": 886.682, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}, {"name": "encryption_service", "msg": "Encryption service initialized", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/ray/Desktop/GITHUB/Novamind-Backend-ONLY-TWINS/backend/app/infrastructure/security/encryption_service.py", "filename": "encryption_service.py", "module": "encryption_service", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 79, "funcName": "__init__", "created": 1744671638.460628, "msecs": 460.0, "relativeCreated": 930.223, "thread": 8631733312, "threadName": "MainThread", "processName": "MainProcess", "process": 31166, "taskName": null, "asctime": "2025-04-14 19:00:38"}], "longrepr": "@pytest.fixture\n    def encryption_service():\n        \"\"\"Create a test encryption service.\"\"\"\n        # Use a test key, never use in production\n        test_key = b\"testkeyfortestingonly1234567890abcdef\"\n        service = EncryptionService()\n    \n        # Mock the key loading to use our test key\n>       with patch.object(service, \"_load_encryption_key\") as mock_load:\n\ndb/test_repository_security.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1495: in __enter__\n    original, local = self.get_original()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <unittest.mock._patch object at 0x104ffd9b0>\n\n    def get_original(self):\n        target = self.getter()\n        name = self.attribute\n    \n        original = DEFAULT\n        local = False\n    \n        try:\n            original = target.__dict__[name]\n        except (AttributeError, KeyError):\n            original = getattr(target, name, DEFAULT)\n        else:\n            local = True\n    \n        if name in _builtins and isinstance(target, ModuleType):\n            self.create = True\n    \n        if not self.create and original is DEFAULT:\n>           raise AttributeError(\n                \"%s does not have the attribute %r\" % (target, name)\n            )\nE           AttributeError: <app.infrastructure.security.encryption_service.EncryptionService object at 0x104e19c50> does not have the attribute '_load_encryption_key'\n\n/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1465: AttributeError"}, "teardown": {"duration": 0.00016341597074642777, "outcome": "passed"}}]}